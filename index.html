<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  
  <!-- Primary Meta Tags -->
  <!-- TODO: Replace with your paper title and author names -->
  <meta name="title" content="Patronus: Interpretable Diffusion Models with Prototypes">
  <!-- TODO: Write a compelling 150-160 character description of your research -->
  <meta name="description" content="Opening the black box of diffusion models with prototype-based interpretability: what visual patterns are learned, where, and when.">
  <!-- TODO: Add 5-10 relevant keywords for your research area -->
  <meta name="keywords" content="Interpretability, Diffusion Models, Prototyeps, Shortcut Learning, Visual Concepts">
  <!-- TODO: List all authors -->
  <meta name="author" content="Nina Weng, Aasa Feragen, Siavash Bigdeli">
  <meta name="robots" content="index, follow">
  <meta name="language" content="English">
  
  <!-- Open Graph / Facebook -->
  <meta property="og:type" content="article">
  <!-- TODO: Replace with your institution or lab name -->
  <meta property="og:site_name" content="Project Page">
  <!-- TODO: Same as paper title above -->
  <meta property="og:title" content="Patronus: Interpretable Diffusion Models with Prototypes">
  <!-- TODO: Same as description above -->
  <meta property="og:description" content="Opening the black box of diffusion models with prototype-based interpretability: what visual patterns are learned, where, and when.">
  <!-- TODO: Replace with your actual website URL -->
  <meta property="og:url" content="https://YOUR_DOMAIN.com/YOUR_PROJECT_PAGE">
  <!-- TODO: Create a 1200x630px preview image and update path -->
  <meta property="og:image" content="https://YOUR_DOMAIN.com/static/images/social_preview.png">
  <meta property="og:image:width" content="1200">
  <meta property="og:image:height" content="630">
  <meta property="og:image:alt" content="Patronus: Interpretable Diffusion Models with Prototypes - Research Preview">
  <!-- <meta property="article:published_time" content="2026-02-03T00:00:00.000Z"> -->
  <meta property="article:author" content="Nina Weng">
  <meta property="article:section" content="Research">
  <meta property="article:tag" content="Interpretability">
  <meta property="article:tag" content="Diffusion Models">



  <!-- Academic/Research Specific -->
  <meta name="citation_title" content="Patronus: Interpretable Diffusion Models with Prototypes">
  <meta name="citation_author" content="Weng, Nina">
  <meta name="citation_author" content="Feragen, Aasa">
  <meta name="citation_author" content="Bigdeli, Siavash">
  <meta name="citation_publication_date" content="2026">
  <meta name="citation_conference_title" content="ICLR">
  <meta name="citation_pdf_url" content="https://YOUR_DOMAIN.com/static/pdfs/paper.pdf">


  <!-- TODO: Replace with your paper title and authors -->
  <title>Patronus: Interpretable Diffusion Models with Prototypes</title>
  
  <!-- Favicon and App Icons -->
  <link rel="icon" type="image/x-icon" href="static/images/icon.png">
  <link rel="apple-touch-icon" href="static/images/icon.png">
  
  <!-- Critical CSS - Load synchronously -->
  <link rel="stylesheet" href="static/css/bulma.min.css">
  <link rel="stylesheet" href="static/css/index.css">

  <!-- font -->
  <!-- <link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Serif:wght@400;500;600;700&display=swap" rel="stylesheet"> -->
  <link href="https://fonts.googleapis.com/css2?family=Lora:wght@400;700&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Quintessential&display=swap" rel="stylesheet">
  
  <!-- Non-critical CSS - Load asynchronously -->
  <link rel="preload" href="static/css/bulma-carousel.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
  <link rel="preload" href="static/css/bulma-slider.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
  <link rel="preload" href="static/css/fontawesome.all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
  <link rel="preload" href="https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1/css/academicons.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
  
  
  <!-- Fallback for browsers that don't support preload -->
  <noscript>
    <link rel="stylesheet" href="static/css/bulma-carousel.min.css">
    <link rel="stylesheet" href="static/css/bulma-slider.min.css">
    <link rel="stylesheet" href="static/css/fontawesome.all.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1/css/academicons.min.css">
  </noscript>
  
  <!-- Fonts - Optimized loading -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
  
  <!-- Defer non-critical JavaScript -->
  <script defer src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script defer src="https://documentcloud.adobe.com/view-sdk/main.js"></script>
  <script defer src="static/js/fontawesome.all.min.js"></script>
  <script defer src="static/js/bulma-carousel.min.js"></script>
  <script defer src="static/js/bulma-slider.min.js"></script>
  <script defer src="static/js/index.js"></script>
  
  <!-- Structured Data for Academic Papers -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "ScholarlyArticle",
    "headline": "PAPER_TITLE",
    "description": "BRIEF_DESCRIPTION_OF_YOUR_RESEARCH_CONTRIBUTION_AND_FINDINGS",
    "author": [
      {
        "@type": "Person",
        "name": "FIRST_AUTHOR_NAME",
        "affiliation": {
          "@type": "Organization",
          "name": "INSTITUTION_NAME"
        }
      },
      {
        "@type": "Person",
        "name": "SECOND_AUTHOR_NAME",
        "affiliation": {
          "@type": "Organization",
          "name": "INSTITUTION_NAME"
        }
      }
    ],
    "datePublished": "2024-01-01",
    "publisher": {
      "@type": "Organization",
      "name": "CONFERENCE_OR_JOURNAL_NAME"
    },
    "url": "https://YOUR_DOMAIN.com/YOUR_PROJECT_PAGE",
    "image": "https://YOUR_DOMAIN.com/static/images/social_preview.png",
    "keywords": ["KEYWORD1", "KEYWORD2", "KEYWORD3", "machine learning", "computer vision"],
    "abstract": "FULL_ABSTRACT_TEXT_HERE",
    "citation": "BIBTEX_CITATION_HERE",
    "isAccessibleForFree": true,
    "license": "https://creativecommons.org/licenses/by/4.0/",
    "mainEntity": {
      "@type": "WebPage",
      "@id": "https://YOUR_DOMAIN.com/YOUR_PROJECT_PAGE"
    },
    "about": [
      {
        "@type": "Thing",
        "name": "RESEARCH_AREA_1"
      },
      {
        "@type": "Thing", 
        "name": "RESEARCH_AREA_2"
      }
    ]
  }
  </script>
  
  <!-- Website/Organization Structured Data -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "Organization",
    "name": "INSTITUTION_OR_LAB_NAME",
    "url": "https://YOUR_INSTITUTION_WEBSITE.com",
    "logo": "https://YOUR_DOMAIN.com/static/images/favicon.ico",
    "sameAs": [
      "https://twitter.com/YOUR_TWITTER_HANDLE",
      "https://github.com/YOUR_GITHUB_USERNAME"
    ]
  }
  </script>
</head>
<body>




  <main id="main-content">
  <section class="hero">
    <div class="hero-body">
      <div class="container is-max-desktop">
        <div class="columns is-centered">
          <div class="column has-text-centered">
            <!-- TODO: Replace with your paper title -->
            <h1 class="title is-1 publication-title">ðŸª„<span class="fancy-title">Patronus</span>: Interpretable Diffusion Models with Prototypes</h1>
            <div class="is-size-5 publication-authors">
              <!-- TODO: Replace with your paper authors and their personal links -->
              <span class="author-block">
                <a href="https://nina-weng.github.io/" target="_blank">Nina Weng</a>,</span>
                <span class="author-block">
                  <a href="https://www2.compute.dtu.dk/~afhar/" target="_blank">Aasa Feragen</a>,</span>
                  <span class="author-block">
                    <a href="https://people.compute.dtu.dk/sarbi/" target="_blank">Siavash Bigdeli</a>
                  </span>
                  </div>

                  <div class="is-size-5 publication-authors">
                    <!-- TODO: Replace with your institution and conference/journal info -->
                    <span class="author-block">Technical University of Denmark<br><b>Accepted at ICLR 2026</b></span>
                  </div>

                  <div class="column has-text-centered">
                    <div class="publication-links">
                         <!-- TODO: Update with your arXiv paper ID -->
                      <span class="link-block">
                        <a href="https://arxiv.org/pdf/2503.22782" target="_blank"
                        class="external-link button is-normal is-rounded is-dark">
                        <span class="icon">
                          <i class="fas fa-file-pdf"></i>
                        </span>
                        <span>Paper</span>
                      </a>
                    </span>

                    <!-- TODO: Add your supplementary material PDF or remove this section -->
                    <span class="link-block">
                      <a href="static/pdfs/patronus_sup.pdf" target="_blank"
                      class="external-link button is-normal is-rounded is-dark">
                      <span class="icon">
                        <i class="fas fa-file-pdf"></i>
                      </span>
                      <span>Supplementary</span>
                    </a>
                  </span>

                  <!-- TODO: Replace with your GitHub repository URL -->
                  <span class="link-block">
                    <a href="https://github.com/nina-weng/patronus" target="_blank"
                    class="external-link button is-normal is-rounded is-dark">
                    <span class="icon">
                      <i class="fab fa-github"></i>
                    </span>
                    <span>Code</span>
                  </a>
                </span>

                <!-- TODO: Update with your arXiv paper ID -->
                <span class="link-block">
                  <a href="https://arxiv.org/abs/2503.22782" target="_blank"
                  class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                    <i class="ai ai-arxiv"></i>
                  </span>
                  <span>arXiv</span>
                </a>
              </span>



                <!-- demo -->
              <span class="link-block">
                <a href="#" target="_blank"
                class="external-link button is-normal is-rounded is-dark"
                style="pointer-events: none; opacity: 0.5;" title="Coming Soon">
                  <span class="icon">
                    <i class="fas fa-eye"></i>
                  </span>
                  <span>Demo (Coming Soon)</span>
                </a>
              </span>


            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>



<!-- Teaser figure -->
<section class="hero teaser">
  <div class="container is-max-desktop">
    <div class="hero-body">
      <img src="static/images/teaser_page-0001.jpg" alt="Main figure description" style="width: 100%;margin-bottom: 20px;">
      <h2 class="subtitle has-text-centered">
        <p class="subtitle has-text-centered">
          <b>Proposed <i>Patronus</i> model</b>. <br>
          <b>(a) Interpretability</b>: By integrating a prototypical network as the encoder, <i>Patronus</i> learns semantic prototypes (<i>"what"</i>) and explains the generative process by revealing <i>where</i> and <i>when</i> they emerge.
          <b>(b) Diagnosis:</b> <i>Patronus</i>  could detect unwanted correlation (e.g., in this case hair color and smile) learned from training data.
          <b>(c) Overview of <i>Patronus</i></b>: contains a prototypical network for prototype extraction and a conditional DDPM for generation.
        </p>
      </h2>
    </div>
  </div>
</section>
<!-- End teaser figure -->

<!-- Paper abstract -->
<section class="section hero is-light">
  <div class="container is-max-desktop">
    <div class="columns is-centered has-text-centered">
      <div class="column is-four-fifths">
        <h2 class="title is-3">Abstract</h2>
        <div class="content has-text-justified">
          <!-- TODO: Replace with your paper abstract -->
          <p>
            Uncovering the opacity of diffusion-based generative models is urgently needed, 
            as their applications continue to expand while their underlying procedures largely remain a black box. 
            With a critical question -- how can the diffusion generation process be interpreted and understood? -- we proposed <i>Patronus</i>, 
            an interpretable diffusion model that incorporates a prototypical network to encode semantics in visual patches, 
            revealing<i>what</i> visual patterns are learned and <i>where</i> and <i>when</i> they emerge throughout denoising. 
            This interpretability of <i>Patronus</i> provides deeper insights into the generative mechanism, 
            enabling the detection of shortcut learning via unwanted correlations and the tracing of semantic emergence across timesteps. 
            We evaluate <i>Patronus</i> on four natural image datasets and one medical imaging dataset, 
            demonstrating both faithful interpretability and strong generative performance. 
            With this work, we open new avenues for understanding and steering diffusion models through prototype-based interpretability.  
          </p>
        </div>
      </div>
    </div>
  </div>
</section>
<!-- End paper abstract -->



  <section class="hero is-small" style="margin-top: 50px;">
    <div class="container is-max-desktop">
      <div class="hero-body has-text-centered">
        <h2 class="title is-3">Proposed method: <span class="fancy-title">Patronus</span></h2>
        <img src="static/images/patronus_illustration_v4_page-0001.jpg" alt="Method overview" style="width: 60%; margin-top: -20px;margin-bottom: 20px;">
        <p class="subtitle has-text-centered"> 
          <span class="fancy-title">Patronus</span>: Prototype-Assisted Transparent Diffusion Model, 
          incorporates a prototype extraction and representation module.
          This module learns patch-based prototypes within the image and computes similarity score for each prototype, 
          which are then used to condition the diffusion process.
        </p>
      </div>
    </div>
  </section>


  <section class="hero is-small" style="margin-top: 50px;">
    <div class="container is-max-desktop">
      <div class="hero-body">
        <h2 class="title is-3 has-text-centered">Proposed Prototype Visualization Method</h2>
        <div class="content has-text-justified">
          <p>
            Each learned prototype <i>p<sub>j</sub></i> represents a semantic patch. 
            Unlike ProtoPNet which retrieves prototypes by searching for closest training patches, 
            we argue prototypes should align with the overall data distribution.
          </p>
          <p>
            <b>Our visualization method:</b><br>
            (1) Compute activation scores <i>s</i> for sample <i>x<sub>0</sub></i>;<br>
            (2) Maximize target prototype score <i>s<sub>J</sub></i> while keeping others fixed;<br>
            (3) Generate new image <i>x'</i> conditioned on updated <i>s'</i>;<br>
            (4) Extract the most activated patch as the prototype visualization.
          </p>
          <p>
            This method generalizes to other prototypical deep learning models.
          </p>
        </div>
      </div>
    </div>
  </section>


  <section class="hero is-small" style="margin-top: 50px;">
    <div class="container is-max-desktop">
      <div class="hero-body has-text-centered">
        <h2 class="title is-3">Assessing Semantic Meaning of Learned Prototypes</h2>
        <img src="static/images/semantic_meaning_v4_page-0001.jpg" alt="Semantic meaning assessment" style="width: 100%; margin-top: -20px; margin-bottom: 20px;">
        <p class="subtitle has-text-centered">
          We verify that learned prototypes are <i>semantically meaningful</i> through three analyses:<br>
          <b>(a) Reconstruction:</b> Generating images from prototype activations accurately recreates semantic content.
          <b>(b) Extrapolation:</b> Extending prototype activations beyond observed values produces coherent variations.
          <b>(c) Interpolation:</b> Smoothly transitioning between two images' prototype activations yields meaningful intermediate samples. 
          Left: CheXpert (75-year-old female <i>w/o</i> enlarged heart â†’ 27-year-old male <i>w/</i> enlarged heart). Right: CelebA examples.
        </p>
      </div>
    </div>
  </section>

  <section class="hero is-small" style="margin-top: 50px;">
    <div class="container is-max-desktop">
      <div class="hero-body">
        <h2 class="title is-3 has-text-centered">Prototype Visualization and Consistency</h2>
        <div class="has-text-centered">
          <img src="static/images/vis_p_v2_page-0001.jpg" alt="Prototype visualization" style="width: 80%; margin-top: -20px; margin-bottom: 20px;">
        </div>
        <div class="content has-text-justified">
          <p>
            Unlike other autoencoder-based diffusion models, <i>Patronus</i> yields an interpretable semantic latent space where each prototype captures distinct semantic content. 
            We visualize prototypes by amplifying their activation and extracting the most responsive patch.
          </p>
          <p>
            <b>(a) Prototype visualization:</b> 
            <i>x<sub>0</sub></i> denotes the original image, <i>xÌ‚<sub>0,s'</sub></i> denotes the generated image guided by enhanced prototype activation <i>s'</i>. 
            Red square highlights the most activated patch, which serves as the visual representation of the chosen prototype (shown in third row). 
            Note that prototype semantics are not pre-annotated but inferred through observation.
          </p>
          <p>
            <b>(b) Consistency:</b> 
            Visualization across random samples demonstrates that each prototype encodes consistent semantics.
          </p>
        </div>
      </div>
    </div>
  </section>

  <section class="hero is-small"  style="margin-top: 50px;">
    <div class="container is-max-desktop">
      <div class="hero-body">
        <h2 class="title is-3 has-text-centered"><i>Patronus</i> as an Interpretable Tool</h2>
        <div class="has-text-centered">
          <img src="static/images/interpretable_tool_v2_page-0001.jpg" alt="Patronus as interpretable tool" style="width: 80%; margin-top: -30px;">
        </div>
        <div class="content has-text-justified">
          <p>
            <b>(a) Detecting shortcut learning:</b> 
            We introduced an unwanted correlation in CelebA: blonde/brown-haired images smile, while black-haired ones do not. 
            <i>Patronus</i> captures this biasâ€”increasing the black hair prototype shifts smile to non-smile and vice versa. 
            This demonstrates how <i>Patronus</i> can discover unwanted model behavior such as shortcut learning.
          </p>
          <p>
            <b>(b) Tracing prototype emergence:</b> 
            <i>Patronus</i> reveals <i>when</i> each prototype emerges during generation by tracking similarity scores across timesteps. 
            Low spatial frequency attributes (e.g., "wearing red") appear earlier, while high frequency attributes (e.g., "curly hair") emerge later. 
            This insight can improve image editing efficiency and support bias mitigation once unwanted correlations are detected.
          </p>
        </div>
      </div>
    </div>
  </section>




<!--BibTex citation -->
  <section class="section" id="BibTeX">
    <div class="container is-max-desktop content">
      <div class="bibtex-header">
        <h2 class="title">BibTeX</h2>
        <button class="copy-bibtex-btn" onclick="copyBibTeX()" title="Copy BibTeX to clipboard">
          <i class="fas fa-copy"></i>
          <span class="copy-text">Copy</span>
        </button>
      </div>
      <pre id="bibtex-code"><code>@article{weng2025patronus,
        title={Patronus: Interpretable Diffusion Models with Prototypes},
        author={Weng, Nina and Feragen, Aasa and Bigdeli, Siavash},
        journal={arXiv preprint arXiv:2503.22782},
        year={2025}
      }
</code></pre>
    </div>
</section>
<!--End BibTex citation -->


  <footer class="footer">
  <div class="container">
    <div class="columns is-centered">
      <div class="column is-8">
        <div class="content">

          <p>
            This page was built using the <a href="https://github.com/eliahuhorwitz/Academic-project-page-template" target="_blank">Academic Project Page Template</a> which was adopted from theÂ <a href="https://nerfies.github.io" target="_blank">Nerfies</a>Â project page.
            You are free to borrow the source code of this website, we just ask that you link back to this page in the footer. <br> This website is licensed under a <a rel="license"  href="http://creativecommons.org/licenses/by-sa/4.0/" target="_blank">Creative
            Commons Attribution-ShareAlike 4.0 International License</a>.
          </p>

        </div>
      </div>
    </div>
  </div>
</footer>

<!-- Statcounter tracking code -->
  
<!-- You can add a tracker to track page visits by creating an account at statcounter.com -->

    <!-- End of Statcounter Code -->

  </body>
  </html>
